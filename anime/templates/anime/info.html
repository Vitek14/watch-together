<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>{{ anime.russian }}</title>
  {% load django_bootstrap5 %}
  {% load static %}
  {% bootstrap_css %}
  {% bootstrap_javascript %}
  <link rel="stylesheet" href="https://cdn.vidstack.io/player/theme.css"/>
  <link rel="stylesheet" href="https://cdn.vidstack.io/player/video.css"/>
  <script src="https://cdn.vidstack.io/player" type="module"></script>
  <link rel="stylesheet" type='text/css' href="{% static 'anime/css/info.css' %}">>
    <script type="text/javascript">
    let animeName = "{{ anime.russian|escapejs }}"
    let animeLink="{{ anime_link|escapejs }}"  {# Добавить проверку на существование ссылки #}
    </script>
  <script src="{% static 'anime/js/info.js' %}"></script>
</head>
<body>
<!-- Loading overlay -->
{#<div id="loading-overlay" class="loading-overlay" style="display: none;">#}
{#  <div class="spinner"></div>#}
{#</div>#}
<nav class="navbar navbar-expand-lg bg-light-subtle container">
  <div class="container-fluid">
    <div class="row w-100 align-items-center">
      <div class="col">
        <a class="navbar-brand" href="{% url 'index' %}">
          <img src="{% static 'anime/media/logo.png' %}" alt="Logo" width="72" height="72"
               class="d-inline-block align-text-сenter">
          Каталог
        </a>
      </div>
      <div class="col-8">
        <form class="d-flex" role="search">
          <input class="form-control me-2" type="search" placeholder="Search" aria-label="Search"/>
          {#          <button class="btn btn-outline-success" type="submit">Search</button>#}
        </form>
      </div>
      <div class="col text-end">
        <button class="btn btn-outline-success">Войти</button>
      </div>
    </div>
  </div>
</nav>
<div class="container pt-5">
  <div class="row g-4 align-items-start">
    <div class="col-auto">
      <img src="{{ anime.poster.original_url }}" class="rounded h-50" alt="{{ anime.russian }}"
           style="max-height: 500px">
    </div>
    <div class="col-auto">
      <h1>{{ anime.russian }}<span class="badge text-bg-secondary">{{ anime.rating }}</span></h1>
      <p class="text-secondary">{{ anime.english }}</p>
      <p class="text-body mb-0">Выходит с {{ anime.aired_on.date }}</p>
      <p class="text-body mb-0">Жанры: {{ anime.genres.first }} </p>
      <p>{{ anime.description }}</p>
    </div>
  </div>
</div>

<div class="container mt-3">
  <div class="card">
    <div class="card-header">
      <h5 class="mb-0">Совместный просмотр</h5>
    </div>
    <div class="card-body">
      <div class="d-flex flex-wrap gap-2 mb-3">
        <button id="createRoomBtn" class="btn btn-primary">Создать комнату</button>
        <input type="text" id="roomIdInput" class="form-control" placeholder="ID комнаты" style="width: 200px;">
        <button id="joinRoomBtn" class="btn btn-success">Присоединиться</button>
      </div>
      <div id="roomInfo" class="d-none">
        <p>ID комнаты: <strong id="currentRoomId"></strong></p>
        <p>Участников: <span id="usersCount">1</span></p>
        <button id="copyRoomIdBtn" class="btn btn-sm btn-outline-secondary">Копировать ID</button>
      </div>
    </div>
  </div>
</div>
<!-- Блок управления плеером -->
<div class="container mt-4">
  <div id="player-controls">
    <!-- Здесь появятся кнопки озвучки и сезоны -->
  </div>

  {#  <div class="mt-3">#}
  {#    <div id="translatorsDiv" style="display: none;">#}
  {#      <!-- Здесь появятся эпизоды -->#}
  {#    </div>#}
  {#  </div>#}

  <div class="container pt-5 d-flex align-items-center" id="loading-overlay" style="display: none;">
    <strong role="status">Грузим плеер...</strong>
    <div class="spinner-border ms-auto" aria-hidden="true"></div>
  </div>
  <!-- Плеер -->
  <div class="mt-4">
    {#    <media-player id="main-player" title="{{ anime.russian }}" src="">#}
    {#      <media-provider></media-provider>#}
    {#      <media-video-layout></media-video-layout>#}
    {#    </media-player>#}
    <media-player load="custom">
      <media-provider></media-provider>
      <media-video-layout></media-video-layout>
    </media-player>
  </div>

  <div class="mt-3">
    <div id="episode-controls" style="display: none;">
      <!-- Здесь появятся эпизоды -->
    </div>
  </div>

<div class="toast-container position-fixed bottom-0 end-0 p-3">
  <div id="liveToast" class="toast" role="alert" aria-live="assertive" aria-atomic="true">
    <div class="toast-header">
      <strong class="me-auto">Вход пользователя</strong>
{#      <small>11 mins ago</small>#}
      <button type="button" class="btn-close" data-bs-dismiss="toast" aria-label="Close"></button>
    </div>
    <div class="toast-body">
      Пользователь зашёл!
    </div>
  </div>
</div>
</div>
</body>
</html>
